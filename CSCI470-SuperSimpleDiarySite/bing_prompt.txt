Given the MySQL user diaryappdbuser@localhost IDENTIFIED BY 'DiaryPass$' and the database diaryappdb with the tables: `tbl_users` ( `username` VARCHAR(255) UNIQUE NOT NULL, `password` VARCHAR(40) NOT NULL, `first_name` VARCHAR(40) NOT NULL, `middle_initial` CHAR(1), `last_name` VARCHAR(40) NOT NULL, `last_successful_logon` DATETIME DEFAULT NULL, `last_unsuccessful_logon` DATETIME DEFAULT NULL, `num_logons` INT(5) DEFAULT 0 ), `tbl_logon_attempts` ( `username` VARCHAR(255) NOT NULL, `attempt_datetime` DATETIME NOT NULL, `status` ENUM('SUCCESS', 'FAILURE'), `ipaddress` VARCHAR(39), `user_agent` VARCHAR(255), FOREIGN KEY (`username`) REFERENCES `tbl_users`(`username`) ), and `tbl_diary_entries` ( `username` VARCHAR(255) NOT NULL, `entry_datetime` DATETIME NOT NULL, `entry` VARCHAR(255) NOT NULL, FOREIGN KEY (`username`) REFERENCES `tbl_users`(`username`) ) and the styles.css file:
.invalid p { color: red; } #login-button { border-radius: 4px; background-color: #3264a8; border: none; color: white; padding: 15px 32px; text-align: center; text-decoration: none; display: inline-block; font-size: 16px; } .header { display: flex; } .item { flex: 1; display: flex; justify-content: center; align-items: center; } .item:first-child > span { margin-right: auto; } .item:last-child > span { margin-left: auto; } #buy-button { border-radius: 4px; background-color: #3264a8; border: none; color: white; padding: 15px 32px; text-align: center; text-decoration: none; display: inline-block; font-size: 16px; cursor: pointer; } .dropbtn { border-radius: 4px; background-color: #3264a8; border: none; color: white; padding: 15px 32px; text-align: center; text-decoration: none; display: inline-block; font-size: 16px; } .dropdown { position: relative; display: inline-block; } .dropdown-content { display: none; position: absolute; right: 0; background-color: #f9f9f9; min-width: 160px; box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2); z-index: 1; } .dropdown-content a { color: black; padding: 12px 16px; text-decoration: none; display: block; } .dropdown-content a:hover { background-color: #f1f1f1; } .dropdown:hover .dropdown-content { display: block; } .dropdown:hover .dropbtn { background-color: #295088; } .entry-container { flex: 1; display: flex; justify-content: center; align-items: center; flex-direction: row; } .entry-container:first-child > span { margin-right: auto; } .entry-container:last-child > span { margin-left: auto; } .entry { border: 1px solid black; padding: 10px; margin: 10px; width: 300px; height: 200px; overflow: auto; } .arrow { border: none; background-color: transparent; font-size: 24px; cursor: pointer; } .prev { margin-right: 10px; } .next { margin-left: 10px; } .arrow-container { min-width: 50px; }
And the file view_diary.php (1/2): <!DOCTYPE html> <center> <?php $servername = "localhost"; $username = "diaryappdbuser"; $password = "DiaryPass$"; $dbname = "diaryappdb"; // Create connection $conn = new mysqli($servername, $username, $password, $dbname); // Check connection if ($conn->connect_error) { die("Connection failed: " . $conn->connect_error); } $sql = "SELECT COUNT(*) as total_entries FROM tbl_diary_entries WHERE username='" . $_SESSION['username'] . "'"; $result = $conn->query($sql); $row = $result->fetch_assoc(); $total_entries = $row['total_entries']; // Get the current entry index from the session variable or set it to 0 if it doesn't exist $entry_index = isset($_SESSION['entry_index']) ? $_SESSION['entry_index'] : 0; // Handle button clicks if (isset($_POST['prev'])) { $entry_index--; } elseif (isset($_POST['next'])) { $entry_index++; } // Get the diary entry for the current user and entry index $sql = "SELECT entry, entry_datetime FROM tbl_diary_entries WHERE username='" . $_SESSION['username'] . "' ORDER BY entry_datetime DESC LIMIT 1 OFFSET " . $entry_index; $result = $conn->query($sql); if ($result->num_rows > 0) { // output data of each row while($row = $result->fetch_assoc()) { // Format the date and time of the diary entry in 12-hour format with AM/PM $entry_datetime = new DateTime($row["entry_datetime"]); $formatted_datetime = $entry_datetime->format('m/d/Y \a\t g:i A'); echo "<h2>Diary entry on " . $formatted_datetime . "</h2>"; $entry = $row['entry']; } } else { $entry = "No more entries"; } // Update the entry index in the session variable $_SESSION['entry_index'] = $entry_index;
(2/2): $conn->close(); ?> <div class="entry-container"> <div class="arrow-container"> <?php if ($entry_index > 0): ?> <form method="post"> <input type="submit" class="arrow prev" name="prev" value="&#8592;"> </form> <?php endif; ?> </div> <div class="entry"> <?php echo $entry ?> </div> <div class="arrow-container"> <?php if ($entry_index < $total_entries - 1): ?> <form method="post"> <input type="submit" class="arrow next" name="next" value="&#8594;"> </form> <?php endif; ?> </div> </div> </center>
